<!DOCTYPE html>
<!-- KaTeX requires the use of the HTML5 doctype. Without it, KaTeX may not render properly -->
<html lang="en">
<head>
    <title></title>
    <link rel="stylesheet" href="katex/katex.min.css">
    <link rel="stylesheet" href="cardStyles.css">
    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script defer src="katex/katex.min.js"></script>

    <!-- To automatically render math in text elements, include the auto-render extension: -->
    <script defer src="katex/contrib/auto-render.min.js"></script>
    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function() {
            let searchParameters = new URL(document.location).searchParams;
            if (searchParameters.get('text') == null) {
                document.getElementById('card_text').innerHTML = "<h3>Please select a deck</h3>"
                return;
            }
             //since atob need url safe base64, we replace the forbidden characters
            document.getElementById('card_text').innerText = atob(searchParameters.get('text').replace('_', '/').replace('-', '+'));
            if (searchParameters.get('type') === 'question') {
                document.getElementById('card_text').classList.add('question')
            } else if (searchParameters.get('type') === 'answer') {
                document.getElementById('card_text').classList.add('answer')
            }

            let radioBoxValues = searchParameters.get('radioBoxValues');
            if (radioBoxValues && searchParameters.get('type') != 'answer') {
                let questionValues = radioBoxValues.split(',');
                let radioBoxesHtml = '';
                for (let i = 0; i < questionValues.length; i++) {
                    radioBoxesHtml += '<label id="questionRadioBox"><input type="radio" name="radio" value="' + questionValues[i] + '">' + questionValues[i] + '</label>';
                }
            document.getElementById('card_text').innerHTML += radioBoxesHtml;
            }

            let radioButtons = document.querySelectorAll('input[type="radio"]');
            radioButtons.forEach(function(radioButton) {
                radioButton.addEventListener('click', function() {
                    var values = Array.from(radioButtons).filter(function(radioButton) {
                        return radioButton.checked;
                    }).map(function(radioButton) {
                        return radioButton.value;
                    }).join(';');

                    // Appeler la fonction JavaScript dans la WebView pour transmettre les valeurs des boutons radio
                    window.javaAppInterface.handleRadioBoxValues(values);
                });
            });

            // Render any LaTeX math in the page
            renderMathInElement(document.body);
        });
    </script>
</head>
<body>
<div id="card_text"></div>
</body>
</html>
